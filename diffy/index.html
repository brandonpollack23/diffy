<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Tools for finding and manipulating differences between files"><meta name="keywords" content="rust, rustlang, rust-lang, diffy"><title>diffy - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../diffy/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../diffy/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate diffy</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.3.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul></div><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../diffy/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">diffy</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/diffy/lib.rs.html#1-225">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Tools for finding and manipulating differences between files</p>
<h3 id="overview"><a href="#overview">Overview</a></h3>
<p>This library is intended to be a collection of tools used to find and
manipulate differences between files inspired by <a href="http://www.xmailserver.org/xdiff-lib.html">LibXDiff</a> and <a href="https://www.gnu.org/software/diffutils/">GNU
Diffutils</a>. Version control systems like <a href="https://git-scm.com/">Git</a> and <a href="https://www.mercurial-scm.org/">Mercurial</a> generally
communicate differences between two versions of a file using a <code>diff</code> or
<code>patch</code>.</p>
<p>The current diff implementation is based on the <a href="http://www.xmailserver.org/diff2.pdf">Myers’ diff algorithm</a>.</p>
<h3 id="utf-8-and-non-utf-8"><a href="#utf-8-and-non-utf-8">UTF-8 and Non-UTF-8</a></h3>
<p>This library has support for working with both utf8 and non-utf8 texts.
Most of the API’s have two different variants, one for working with utf8
<code>str</code> texts (e.g. <a href="fn.create_patch.html"><code>create_patch</code></a>) and one for working with bytes <code>[u8]</code>
which may or may not be utf8 (e.g. <a href="fn.create_patch_bytes.html"><code>create_patch_bytes</code></a>).</p>
<h3 id="creating-a-patch"><a href="#creating-a-patch">Creating a Patch</a></h3>
<p>A <a href="struct.Patch.html"><code>Patch</code></a> between two texts can be created by doing the following:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">diffy::create_patch</span>;

<span class="kw">let</span> <span class="ident">original</span> <span class="op">=</span> <span class="string">&quot;The Way of Kings\nWords of Radiance\n&quot;</span>;
<span class="kw">let</span> <span class="ident">modified</span> <span class="op">=</span> <span class="string">&quot;The Way of Kings\nWords of Radiance\nOathbringer\n&quot;</span>;

<span class="kw">let</span> <span class="ident">patch</span> <span class="op">=</span> <span class="ident">create_patch</span>(<span class="ident">original</span>, <span class="ident">modified</span>);</code></pre></div>
<p>A <a href="struct.Patch.html"><code>Patch</code></a> can the be output in the <a href="https://en.wikipedia.org/wiki/Diff#Unified_format">Unified Format</a> either by using its
<a href="https://doc.rust-lang.org/stable/std/fmt/trait.Display.html"><code>Display</code></a> impl or by using a <a href="struct.PatchFormatter.html"><code>PatchFormatter</code></a> to output the diff with
color.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// Without color</span>
<span class="macro">print!</span>(<span class="string">&quot;{}&quot;</span>, <span class="ident">patch</span>);

<span class="comment">// With color</span>
<span class="kw">let</span> <span class="ident">f</span> <span class="op">=</span> <span class="ident">PatchFormatter::new</span>().<span class="ident">with_color</span>();
<span class="macro">print!</span>(<span class="string">&quot;{}&quot;</span>, <span class="ident">f</span>.<span class="ident">fmt_patch</span>(<span class="kw-2">&amp;</span><span class="ident">patch</span>));</code></pre></div>
<div class="example-wrap"><pre class="language-console"><code>--- original
+++ modified
@@ -1,2 +1,3 @@
 The Way of Kings
 Words of Radiance
+Oathbringer</code></pre></div><h3 id="applying-a-patch"><a href="#applying-a-patch">Applying a Patch</a></h3>
<p>Once you have a <a href="struct.Patch.html"><code>Patch</code></a> you can apply it to a base image in order to
recover the new text. Each hunk will be applied to the base image in
sequence. Similarly to GNU <code>patch</code>, this implementation can detect when
line numbers specified in the patch are incorrect and will attempt to find
the correct place to apply each hunk by iterating forward and backward
from the given position until all context lines from a hunk match the base
image.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">diffy</span>::{<span class="ident">apply</span>, <span class="ident">Patch</span>};

<span class="kw">let</span> <span class="ident">s</span> <span class="op">=</span> <span class="string">&quot;\
--- a/skybreaker-ideals
+++ b/skybreaker-ideals
@@ -10,6 +10,8 @@
 First:
     Life before death,
     strength before weakness,
     journey before destination.
 Second:
-    I will put the law before all else.
+    I swear to seek justice,
+    to let it guide me,
+    until I find a more perfect Ideal.
&quot;</span>;

<span class="kw">let</span> <span class="ident">patch</span> <span class="op">=</span> <span class="ident">Patch::from_str</span>(<span class="ident">s</span>).<span class="ident">unwrap</span>();

<span class="kw">let</span> <span class="ident">base_image</span> <span class="op">=</span> <span class="string">&quot;\
First:
    Life before death,
    strength before weakness,
    journey before destination.
Second:
    I will put the law before all else.
&quot;</span>;

<span class="kw">let</span> <span class="ident">expected</span> <span class="op">=</span> <span class="string">&quot;\
First:
    Life before death,
    strength before weakness,
    journey before destination.
Second:
    I swear to seek justice,
    to let it guide me,
    until I find a more perfect Ideal.
&quot;</span>;

<span class="macro">assert_eq!</span>(<span class="ident">apply</span>(<span class="ident">base_image</span>, <span class="kw-2">&amp;</span><span class="ident">patch</span>).<span class="ident">unwrap</span>(), <span class="ident">expected</span>);</code></pre></div>
<h3 id="performing-a-three-way-merge"><a href="#performing-a-three-way-merge">Performing a Three-way Merge</a></h3>
<p>Two files <code>A</code> and <code>B</code> can be merged together given a common ancestor or
original file <code>O</code> to produce a file <code>C</code> similarly to how <a href="https://en.wikipedia.org/wiki/Diff3">diff3</a>
performs a three-way merge.</p>
<div class="example-wrap"><pre class="language-console"><code>    --- A ---
  /           \
 /             \
O               C
 \             /
  \           /
    --- B ---</code></pre></div>
<p>If files <code>A</code> and <code>B</code> modified different regions of the original file <code>O</code>
(or the same region in the same way) then the files can be merged without
conflict.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">diffy::merge</span>;

<span class="kw">let</span> <span class="ident">original</span> <span class="op">=</span> <span class="string">&quot;the final empire\nThe Well of Ascension\nThe hero of ages\n&quot;</span>;
<span class="kw">let</span> <span class="ident">a</span> <span class="op">=</span> <span class="string">&quot;The Final Empire\nThe Well of Ascension\nThe Hero of Ages\n&quot;</span>;
<span class="kw">let</span> <span class="ident">b</span> <span class="op">=</span> <span class="string">&quot;The Final Empire\nThe Well of Ascension\nThe hero of ages\n&quot;</span>;
<span class="kw">let</span> <span class="ident">expected</span> <span class="op">=</span> <span class="string">&quot;\
The Final Empire
The Well of Ascension
The Hero of Ages
&quot;</span>;

<span class="macro">assert_eq!</span>(<span class="ident">merge</span>(<span class="ident">original</span>, <span class="ident">a</span>, <span class="ident">b</span>).<span class="ident">unwrap</span>(), <span class="ident">expected</span>);</code></pre></div>
<p>If both files <code>A</code> and <code>B</code> modified the same region of the original file
<code>O</code> (and those modifications are different), it would result in a conflict
as it is not clear which modifications should be used in the merged
result.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">diffy::merge</span>;

<span class="kw">let</span> <span class="ident">original</span> <span class="op">=</span> <span class="string">&quot;The Final Empire\nThe Well of Ascension\nThe hero of ages\n&quot;</span>;
<span class="kw">let</span> <span class="ident">a</span> <span class="op">=</span> <span class="string">&quot;The Final Empire\nThe Well of Ascension\nThe Hero of Ages\nSecret History\n&quot;</span>;
<span class="kw">let</span> <span class="ident">b</span> <span class="op">=</span> <span class="string">&quot;The Final Empire\nThe Well of Ascension\nThe hero of ages\nThe Alloy of Law\n&quot;</span>;
<span class="kw">let</span> <span class="ident">expected</span> <span class="op">=</span> <span class="string">&quot;\
The Final Empire
The Well of Ascension
&lt;&lt;&lt;&lt;&lt;&lt;&lt; ours
The Hero of Ages
Secret History
||||||| original
The hero of ages
=======
The hero of ages
The Alloy of Law
&gt;&gt;&gt;&gt;&gt;&gt;&gt; theirs
&quot;</span>;

<span class="macro">assert_eq!</span>(<span class="ident">merge</span>(<span class="ident">original</span>, <span class="ident">a</span>, <span class="ident">b</span>).<span class="ident">unwrap_err</span>(), <span class="ident">expected</span>);</code></pre></div>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ApplyError.html" title="diffy::ApplyError struct">ApplyError</a></div><div class="item-right docblock-short"><p>An error returned when <a href="fn.apply.html"><code>apply</code></a>ing a <code>Patch</code> fails</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DiffOptions.html" title="diffy::DiffOptions struct">DiffOptions</a></div><div class="item-right docblock-short"><p>A collection of options for modifying the way a diff is performed</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Hunk.html" title="diffy::Hunk struct">Hunk</a></div><div class="item-right docblock-short"><p>Represents a group of differing lines between two files</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.HunkRange.html" title="diffy::HunkRange struct">HunkRange</a></div><div class="item-right docblock-short"><p>The range of lines in a file for a particular <code>Hunk</code>.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.MergeOptions.html" title="diffy::MergeOptions struct">MergeOptions</a></div><div class="item-right docblock-short"><p>A collection of options for modifying the way a merge is performed</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ParsePatchError.html" title="diffy::ParsePatchError struct">ParsePatchError</a></div><div class="item-right docblock-short"><p>An error returned when parsing a <code>Patch</code> using <a href="struct.Patch.html#method.from_str"><code>Patch::from_str</code></a> fails</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Patch.html" title="diffy::Patch struct">Patch</a></div><div class="item-right docblock-short"><p>Representation of all the differences between two files</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PatchFormatter.html" title="diffy::PatchFormatter struct">PatchFormatter</a></div><div class="item-right docblock-short"><p>Struct used to adjust the formatting of a <code>Patch</code></p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ConflictStyle.html" title="diffy::ConflictStyle enum">ConflictStyle</a></div><div class="item-right docblock-short"><p>Style used when rendering a conflict</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Line.html" title="diffy::Line enum">Line</a></div><div class="item-right docblock-short"><p>A line in either the old file, new file, or both.</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.apply.html" title="diffy::apply fn">apply</a></div><div class="item-right docblock-short"><p>Apply a <code>Patch</code> to a base image</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.apply_bytes.html" title="diffy::apply_bytes fn">apply_bytes</a></div><div class="item-right docblock-short"><p>Apply a non-utf8 <code>Patch</code> to a base image</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.create_patch.html" title="diffy::create_patch fn">create_patch</a></div><div class="item-right docblock-short"><p>Create a patch between two texts.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.create_patch_bytes.html" title="diffy::create_patch_bytes fn">create_patch_bytes</a></div><div class="item-right docblock-short"><p>Create a patch between two potentially non-utf8 texts</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.merge.html" title="diffy::merge fn">merge</a></div><div class="item-right docblock-short"><p>Merge two files given a common ancestor.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.merge_bytes.html" title="diffy::merge_bytes fn">merge_bytes</a></div><div class="item-right docblock-short"><p>Perform a 3-way merge between potentially non-utf8 texts</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="diffy" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0 (4b91a6ea7 2022-08-08)" ></div>
</body></html>